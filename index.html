<head>
    <title>
        The New TSN Central Officer Records
    </title>
    <script type="module" src="main.js"></script>
    <link rel="stylesheet" href="layout.css" />
</head>
<body>
    <p>
        Styling is a thing which I will do later.
    </p>
    <!-- The v-scope directive causes this entire div to be managed by petite-vue. This makes the templating work, as well as enabling a bunch of other similar directives like v-for, v-model, etc. -->
    <div v-scope id="main-content">
        <button @click="refreshData">Refresh</button>
        <button @click="showOfficers">Officers</button>
        <button @click="showShips">Ships</button>
        <p v-if="officersLoading">Refreshing...</p>
        <div v-if="displayTab == 'officers'" id="officers" class="tab-pane">
            <div id="officer-search" class="tab-sidebar">
                <p v-if="filteredOfficers.length === 0">Loading...</p>
                <input v-model="officerSearch" /><br />
                <input type="checkbox" v-model="showInactive" /><label>Show inactive</label>
                <ul>
                    <li v-for="officer in filteredOfficers">
                        <a @click="selectOfficer(officer.name)">
                            {{ getShortRank(officer.rank) }} {{ officer.name }}
                        </a>
                    </li>
                </ul>
            </div>
            <div class="tab-content-wrapper">
                <div v-if="selectedOfficerObject" id="officer-display" class="tab-content">
                    <div class="content-title">
                        <h3 class="section-title officer-name">{{selectedOfficerObject.rank}} {{ selectedOfficerObject.name }}</h3>
                    </div>
                    <div id="basicData">
                        <table class="info-table officer-info">
                            <tr>
                                <td>
                                    <p class="info-title">Enlistment date:</p>
                                    <p>{{ formatDate(selectedOfficerObject.ct) }}</p>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <p class="info-title">Primary expertise:</p>
                                    <p>{{ selectedOfficerObject.primary_expertise }}</p>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <p class="info-title">Secondary expertise:</p>
                                    <p>{{ selectedOfficerObject.secondary_expertise }}</p>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <p class="info-title">Current assignment:</p>
                                    <p>
                                        <a class="internal-link" @click="selectShip(selectedOfficerObject.current_assignment)">TSN {{ selectedOfficerObject.current_assignment }}</a>
                                    </p>
                                </td>
                            </tr>
                        </table>
                    </div>
                    <div id="promotions">
                        <table>
                            <tr v-for="rank in sortedRanks" class="info-entry">
                                <td v-if="officerHasRank(selectedOfficerObject, rank)">
                                    <p class="info-title">{{ rank.name }}:</p>
                                    <p>{{ formatDate(selectedOfficerObject[rank.shortcode.toLowerCase()]) }}</p>
                                </td>
                            </tr>
                        </table>
                    </div>
                    <div id="awards">
                        <div id="ribbonrack">
                            <div class="ribbon" v-for="award in selectedOfficerObject.awards">
                                <img class="ribbon-image" :src="getAwardImageByPath(award.image_file_path)" />
                                <!-- It's the good ol' triple nested overflow fuckery trick. Trust me, they're all needed. -->
                                <div class="ribbon-info-outer-wrapper">
                                    <div class="ribbon-info-inner-wrapper">
                                        <div class="ribbon-info">
                                            <p class="ribbon-title">
                                                {{ award.title }}
                                            </p>
                                            <p v-for="record in award.records" class="ribbon-notes">
                                                {{ formatDate(record.date) }}: {{ record.notes }}
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div v-if="displayTab == 'ships'" id="ships" class="tab-pane">
            <div id="ship-search" class="tab-sidebar">
                <p v-if="shipsLoading">Loading...</p>
                <ul>
                    <li v-for="ship in ships">
                        <a @click="selectShip(ship.name)">
                            TSN {{ ship.name }}
                        </a>
                    </li>
                </ul>
            </div>
            <div class="tab-content-wrapper">
                <div v-if="selectedShipObject" id="ship-display" class="tab-content">
                    <div class="content-title">
                        <h3 class="ship-name section-title">TSN {{selectedShipObject.name}} ({{ selectedShipObject.registry }}) </h3>
                    </div>
                    <div id="basicData">
                        <table class="info-table ship-info">
                            <tr>
                                <td>
                                    <p class="info-title">Registry:</p>
                                    <p>{{ selectedShipObject.registry }}</p>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <p class="info-title">Class:</p>
                                    <p>{{ selectedShipObject.class }}</p>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <p class="info-title">Status:</p>
                                    <p>{{ selectedShipObject.status }}</p>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <p class="info-title">Notes:</p>
                                    <p>{{ selectedShipObject.notes }}</p>
                                </td>
                            </tr>
                        </table>
                    </div>
                    <div id="crew">
                        <h4>Assigned officers:</h4>
                        <ul class="crew-list">
                            <li class="crew-entry" v-for="officer in selectedShipObject.assigned_officers">
                                <a class="internal-link" @click="selectOfficer(officer.name)">
                                    {{ officer.rank }} {{ officer.name }}
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>